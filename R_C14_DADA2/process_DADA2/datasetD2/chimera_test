Test for chimera options.

Problem now is that we lose alot of seq after filtering from chimera (about 50%).
The starting number of ASVs before chimera removal is also very high: 118812, vs for Mazard primer: 8137

From meeting with Adriana and Daniel on 7 Oct 2021, the main concern is the very high number of ASVs before chimera removal. 

I changed the filter and trim settings to reduce the lower quality of the R2 reads. But output of chimera is not different. So should be something else.
  truncLen = c(250, 270) # truncate reads to the length
  minLen = c(250, 270) #remove reads that are shorter.
  truncQ = 2      # Truncate reads at the first instance of a quality score less than or equal to truncQ
  maxEE = c(10, 20) #after truncation, reads with higher than expected errors are discarded. 

#INitial settings to remove chimeras
seqtab.nochim <- removeBimeraDenovo(seqtab, method=method_chimera, multithread=multithread, verbose=TRUE)
From this setting 50% are chimera. original settings from Daniel. Proportion of merged ASVs removed as chimera: 1460/18812


Reading more about chimera formation: 
code and recommendation from here https://github.com/benjjneb/dada2/issues/887
This case had alot of legitimate chimeras : This suggests to me that you may have a dataset with a very high chimera rate, perhaps due to the PCR conditions used to amplify the initial DNA. Certain choices such as high cycle number, short extension times, or insufficient reagents, can increase the amount of chimeras in the final output.
So need to check the chimera output. 

From the output below, the chimeras are not actually chimera
From https://github.com/benjjneb/dada2/issues/900,
After reviewing the example data, I think there probably is a high rate of chimeras in the data, but that also some inter-species variants may be getting errantly flagged as chimeras. This is more common in taxa like Vibrio which have lots of 16S gene copies (~10 on average) and in which there are many closely related "species".

What I'd recommend is to increase the stringency of chimera removal by increasing the minFoldParentOverAbundance parameter. This sets how much more abundant a putative "parent" sequence must be to be evidence for flagging a "child" sequence as chimeric. You should also be using the "consensus" method, as that helps with this issue as well. So something like this...
st <- removeBimeraDenovo(myseqtab, minFoldParentOverAbundance=8, method="consensus", multi=TRUE)
Max minFoldParentOverAbundance is 8.

#Using this code to the check the output.
bim <- isBimeraDenovoTable(seqtab)
table(bim)
dada2:::pfasta(head(getSequences(seqtab)[bim])) #to get few seq that are assigned as chimera.

>1
ATCGGCACAAAGTACGTCCCCCCCCACGTCAATATTTTCTATTGCCTGGGCGGCATCACGTTGGTCTGCTTCCTGATCCAGTTCGCGACAGGGTTCGCGATGACTTTCTATTACAAGCCAACAGTTGCTGAGGCGTATACCTCTGTTCAGTATCTGATGACTGATGTCAGCTTCGGCTGGCTGATTCGTTCGGTGCACCGTTGGAGTGCCTCGATGATGGTGCTCATGCTGATTTTGCATGTGTTCCGGGNNNNNNNNNNGGTGGTTTCAAGCGTCCTCGTGAGCTCACCTGGGTGACTGGTGTCACCATGGCTGTGATCACGGTTTCGTTCGGTGTTACCGGCTACTCCCTTCCCTGGGATCAGGTTGGTTACTGGGCTGTGAAGATTGTCTCCGGCGTTCCTGCGGCCATTCCCGTGGTTGGAGACTTCATGGTTGAGTTACTCCGTGGTGGAGAAAGCGTTGGTCAATCGACTCTGACTCGCTTTTACAGCCTTCACACCTTCGTGATGCCTTGGCTCCTCGCGGTG
>2
ATCGGCACAAAATACGTCCCCCCCCACGTCAATATTTTTTATTGCCTGGGCGGCATCACGTTGGTTTGCTTCTTGATTCAATTCGCGACAGGGTTCGCGATGACTTTCTATTACAAGCCAACAGTTGCTGAGGCCTATACCTCTGTTCAGTACCTGATGACAGACGTCAGCTTCGGCTGGCTGATTCGCTCGGTGCACCGTTGGAGCGCCTCGATGATGGTGCTCATGCTGATTTTGCATGTGTTCCGCGNNNNNNNNNNGGTGGTTTTAAGCGTCCTCGTGAGCTCACTTGGGTGACTGGCGTCACCATGGCTGTGATCACGGTTTCGTTTGGTGTTACCGGCTACTCCCTGCCTTGGGATCAAGTCGGTTACTGGGCTGTGAAGATTGTCTCCGGTGTTCCTGCCGCCATTCCCGTGGTTGGAGACTTCATGGTTGAGTTACTCCGTGGTGGAGAAAGTGTTGGTCAAGCAACGCTCACTCGCTTTTACAGCCTTCACACCTTCGTGATGCCCTGGCTCCTCGCGGTG
>3
ATCGGCACAAAATACGTCCCCCCCCACGTAAATATCTTTTATTGCCTGGGTGGGATCACGTTGGTCTGCTTCCTGATCCAGTTCGCGACAGGGTTCGCGATGACCTTCTACTACAAGCCAACTGTTGCCGAGGCCTACACCTCTGTTCAGTACTTGATGACCGATGTCAGCTTCGGCTGGCTGATTCGTTCGGTGCACCGCTGGAGTGCCTCGATGATGGTTCTCATGCTGATTTTGCATGTGTTCAGGGNNNNNNNNNNGGTGGTTTCAAGCGTCCTCGTGAGCTCACCTGGGTGACTGGTGTCACCATGGCTGTGATCACTGTTTCTTTCGGTGTTACTGGTTACTCCCTGCCTTGGGATCAAGTTGGCTACTGGGCTGTGAAAATTGTTTCCGGTGTTCCAGCAGCCATCCCCGTGGTGGGAGATTTCATGGTTGAGTTGCTCCGTGGTGGAGAGAGTGTTGGTCAATCGACTCTGACGCGTTTCTACAGCCTTCACACCTTTGTGATGCCATGGCTCCTCGCGGTG
>4
ATCGGCACAAAATACGTCCCCCCCCACGTAAATATCTTTTATTGCCTGGGTGGGATCACGTTGGTCTGCTTCCTGATCCAGTTCGCGACAGGGTTCGCGATGACCTTCTACTACAAGCCAACTGTTGCCGAGGCCTACACCTCTGTTCAGTACTTGATGACCGATGTCAGCTTCGGCTGGCTGATTCGTTCGGTGCACCGCTGGAGTGCCTCGATGATGGTTCTCATGCTGATTTTGCATGTGTTCAGGGNNNNNNNNNNGGTGGTTTCAAGCGTCCTCGTGAGCTCACCTGGGTGACTGGTGTCACCATGGCTGTGATCACTGTTTCGTTCGGTGTTACTGGTTACTCCCTGCCTTGGGATCAAGTTGGCTACTGGGCTGTGAAAATTGTTTCCGGTGTTCCAGCAGCCATCCCCGTGGTGGGAGATTTCATGGTTGAGTTGCTCCGTGGTGGAGAGAGTGTTGGTCAATCGACTCTGACGCGTTTCTACAGCCTTCACACCTTTGTGATGCCATGGCTCCTCGCGGTG
>5
ATCGGCACAAAATACGTCCCCCCCCACGTCAATATCTTTTATTGCCTGGGTGGGATCACGTTGGTCTGCTTCCTGATCCAGTTCGCGACAGGGTTCGCGATGACCTTCTACTACAAGCCAACTGTCGCCGAGGCCTACACCTCTGTTCAGTACTTGATGACCGATGTCAGCTTCGGCTGGCTGATTCGTTCGGTGCACCGTTGGAGTGCGTCGATGATGGTTCTCATGCTGATTTTGCATGTGTTCAGGGNNNNNNNNNNGGTGGTTTCAAGCGTCCTCGTGAGCTCACCTGGGTGACTGGTGTCACCATGGCTGTGATCACTGTTTCGTTCGGTGTTACTGGTTACTCCCTGCCTTGGGATCAAGTTGGCTACTGGGCTGTGAAAATTGTTTCCGGTGTTCCAGCAGCCATCCCCGTGGTGGGAGACTTCATGGTTGAGTTGCTCCGTGGTGGAGAGAGTGTTGGTCAATCGACTCTGACGCGTTTCTACAGCCTTCACACTTTTGTGATGCCATGGCTCCTCGCGGTG
>6
ATCGGCACAAAATACGTCCCCCCCCACGTCAATATTTTTTATTGCCTGGGCGGCATCACGTTGGTCTGCTTCCTGATCCAGTTCGCGACAGGGTTCGCGATGACTTTCTATTACAAGCCAACAGTTGCTGAGGCGTATACCTCTGTTCAGTATCTGATGACTGATGTCAGCTTCGGCTGGCTGATTCGTTCGGTGCACCGTTGGAGTGCCTCGATGATGGTGCTCATGCTGATTTTGCATGTGTTCCGGGNNNNNNNNNNGGTGGTTTCAAACGTCCTCGTGAGCTCACCTGGGTGACTGGTGTCACCATGGCTGTGATCACGGTTTCGTTCGGTGTTACCGGCTACTCCCTTCCCTGGGATCAGGTTGGTTACTGGGCTGTGAAGATTGTCTCCGGCGTTCCTGCGGCCATTCCCGTGGTTGGAGACTTCATGGTTGAGTTACTCCGTGGTGGAGAAAGCGTTGGTCAATCGACTCTGACTCGCTTTTACAGCCTTCACACCTTCGTGATGCCTTGGCTCCTCGCGGTG

seqtab.nochim_2 <- removeBimeraDenovo(seqtab, multithread=multithread, verbose=TRUE) 47% non chimera

seqtab.nochim_3 <- removeBimeraDenovo(seqtab, multithread=multithread, verbose=TRUE, minFoldParentOverAbundance=8)  #65% non chimera

1
TTCAGCACCAAGTACGTTCCGCCCCACGTCAATATTTTTTATTGCCTGGGCGGCATCACGCTTGTTTGCTTCCTGATTCAGTTCGCGACAGGGTTCGCGATGACCTTCTACTACAAGCCAACTGTCGCCGAGGCCTACACCTCTGTTCAGTACTTGATGACCGATGTCAGCTTCGGCTGGCTGATTCGTTCGGTGCACCGTTGGAGTGCCTCGATGATGGTTCTCATGCTGATTTTGCATGTGTTCAGGGNNNNNNNNNNGGTGGTTTCAAGCGTCCTCGTGAGCTCACCTGGGTGACTGGTGTCACCATGGCTGTGATCACTGTTTCGTTCGGTGTTACTGGTTACTCCCTGCCTTGGGATCAAGTTGGCTACTGGGCTGTGAAAATTGTTTCCGGTGTTCCAGCAGCCATCCCCGTGGTGGGAGATTTCATGGTTGAGTTGCTCCGTGGTGGAGAGAGTGTTGGTCAATCGACTCTGACGCGTTTCTACAGCCTTCACACCTTTGTGATGCCATGGCTCCTCGCGGTG
>2
TTCAGCACCAAGTACGTTCCGCCCCACGTCAATATTTTTTATTGCCTGGGTGGGATCACGTTGGTCTGCTTCCTGATCCAGTTCGCGACAGGGTTCGCGATGACCTTCTACTACAAGCCAACTGTCGCCGAGGCCTACACCTCTGTTCAGTACTTGATGACCGATGTCAGCTTCGGCTGGCTGATTCGTTCGGTGCACCGTTGGAGTGCCTCGATGATGGTTCTCATGCTGATTTTGCATGTGTTCAGGGNNNNNNNNNNGGTGGTTTCAAGCGTCCTCGTGAGCTCACCTGGGTGACTGGTGTCACCATGGCTGTGATCACTGTTTCGTTCGGTGTTACTGGTTACTCCCTGCCTTGGGATCAAGTTGGCTACTGGGCTGTGAAAATTGTTTCCGGTGTTCCAGCAGCCATCCCCGTGGTGGGAGATTTCATGGTTGAGTTGCTCCGTGGTGGAGAGAGTGTTGGTCAATCGACTCTGACGCGTTTCTACAGCCTTCACACCTTTGTGATGCCATGGCTCCTCGCGGTG
>3
ATCGGCACAAAATACGTCCCCCCCCACGTCAATATTTTTTATTGCCTGGGCGGCATCACGCTTGTTTGCTTCCTGATTCAGTTCGCGACCGGGTTCGCGATGACTTTCTATTACAAGCCCACTGTTGCTGAGGCTTACAGCTCAGTTCAGTACCTGATGTCAGATGTGAGCTTCGGGTGGCTCATCCGCTCAGTTCACAGATGGAGCGCCTCGATGATGGTGCTCATGCTGATTCTCCACGTTTTCCGCGNNNNNNNNNNGGTGGCTTTAAGCGTCCTCGCGAGCTCACTTGGGTGACCGGCGTGACGATGGCAGTGATCACTGTTTCTTTTGGCGTTACCGGCTACTCACTCCCCTGGGATCAAGTTGGTTATTGGGCCGTCAAGATTGTTTCTGGAGTGCCTGCTGCCATTCCAGTTGTTGGTGACTTCATGGTTGAGCTGCTTCGTGGCGGCGAGAGTGTTGGTCAATCCACACTCACCCGCTTTTACAGCCTTCACACGTTTGTGATGCCTTGGTTGCTCGCTGTC
>4
ATCGGCACAAAATACGTCCCCCCCCACGTCAATATTTTTTATTGCCTGGGCGGCATCACGCTTGTTTGCTTCCTGATTCAGTTCGCGACCGGGTTCGCGATGACTTTCTATTACAAGCCCACTGTTGCTGAGGCTTACAGCTCAGTTCAGTACCTGATGTCAGATGTGAGCTTCGGGTGGCTCATCCGCTCAGTTCACAGATGGAGCGCCTCGATGATGGTGCTCATGCTGATTCTCCACGTTTTCCGCGNNNNNNNNNNGGTGGCTTTAAGCGTCCTCGCGAGCTCACTTGGGTGACCGGCGTGACGATGGCAGTGATCACTGTTTCTTTTGGCGTTACCGGCTACTCACTCCCCTGGGATCAAGTTGGTTATTGGGCCGTCAAGATTGTTTCTGGAGTGCCTGCTGCCATTCCAGTTGTTGGTGACTTCATGGTTGAGCTGCTTCGTGGCGGCGAGAGTGTTGGTCAATCCACACTCACCCGCTTCTACAGCCTTCACACGTTTGTGATGCCTTGGTTGCTCGCTGTC
>5
ATCGGCACAAAATACGTCCCCCCCCACGTCAATATCTTTTATTGCCTGGGTGGGATCACGTTGGTCTGCTTCCTGATCCAGTTCGCGACAGGGTTCGCGATGACTTTCTATTACAAGCCCACTGTTGCTGAGGCTTACAGCTCAGTTCAGTACCTGATGTCAGATGTGAGCTTCGGGTGGCTCATCCGCTCAGTTCACAGATGGAGCGCCTCGATGATGGTGCTCATGCTGATTCTCCACGTTTTCCGCGNNNNNNNNNNGGTGGCTTTAAGCGTCCTCGCGAGCTCACTTGGGTGACCGGCGTGACGATGGCAGTGATCACTGTTTCTTTTGGCGTTACCGGCTACTCACTCCCCTGGGATCAAGTTGGTTATTGGGCCGTCAAGATTGTTTCTGGAGTGCCTGCTGCCATTCCAGTTGTTGGTGACTTCATGGTTGAGCTGCTTCGTGGCGGCGAGAGTGTTGGTCAATCCACACTCACCCGCTTCTACAGCCTTCACACGTTTGTGATGCCTTGGTTGCTCGCTGTC
>6
ATCGGCACAAAGTACGTCCCCCCCCACGTCAATATTTTCTATTGCCTGGGCGGCATCACGTTGGTCTGCTTCCTGATCCAGTTCGCGACAGGGTTCGCGATGACTTTCTATTACAAGCCAACAGTTGCTGAGGCGTATACCTCTGTTCAGTATCTGATGACTGATGTCAGCTTCGGCTGGCTGATTCGTTCGGTGCACCGTTGGAGTGCCTCGATGATGGTGCTCATGCTGATTTTGCATGTGTTCCGGGNNNNNNNNNNGGTGGTTTCAAACGTCCTCGTGAGCTCACCTGGGTGACTGGTGTCACCATGGCTGTGATCACGGTTTCGTTCGGTGTTACCGGCTACTCCCTTCCCTGGGATCAGGTTGGTTACTGGGCTGTGAAGATTGTCTCCGGCGTTCCTGCGGCCATTCCCGTGGTTGGAGACTTCATGGTTGAGTTACTCCGTGGTGGAGAAAGCGTTGGTCAATCGACTCTGACTCGCTTTTACAGCCTTCACACCTTCGTGATGCCTTGGCTCCTCGCGGTG

seqtab.nochim_4 <- removeBimeraDenovo(seqtab, minFoldParentOverAbundance=8, method="consensus", multithread = TRUE, verbose = TRUE) #65% non chimera
bim_test <- isBimeraDenovoTable(seqtab, minFoldParentOverAbundance=8, multithread = TRUE, verbose = TRUE)
table(bim_test)


seqtab.nochim_5 <- removeBimeraDenovo(seqtab, minFoldParentOverAbundance=10, method="consensus", multithread = TRUE, verbose = TRUE) #69% non chimera

>1
TTCAGCACCAAGTACGTTCCGCCCCACGTCAATATTTTTTATTGCCTGGGCGGCATCACGCTTGTTTGCTTCCTGATTCAGTTCGCGACAGGGTTCGCGATGACCTTCTACTACAAGCCAACTGTCGCCGAGGCCTACACCTCTGTTCAGTACTTGATGACCGATGTCAGCTTCGGCTGGCTGATTCGTTCGGTGCACCGTTGGAGTGCCTCGATGATGGTTCTCATGCTGATTTTGCATGTGTTCAGGGNNNNNNNNNNGGTGGTTTCAAGCGTCCTCGTGAGCTCACCTGGGTGACTGGTGTCACCATGGCTGTGATCACTGTTTCGTTCGGTGTTACTGGTTACTCCCTGCCTTGGGATCAAGTTGGCTACTGGGCTGTGAAAATTGTTTCCGGTGTTCCAGCAGCCATCCCCGTGGTGGGAGATTTCATGGTTGAGTTGCTCCGTGGTGGAGAGAGTGTTGGTCAATCGACTCTGACGCGTTTCTACAGCCTTCACACCTTTGTGATGCCATGGCTCCTCGCGGTG
>2
TTCAGCACCAAGTACGTTCCGCCCCACGTCAATATTTTTTATTGCCTGGGTGGGATCACGTTGGTCTGCTTCCTGATCCAGTTCGCGACAGGGTTCGCGATGACCTTCTACTACAAGCCAACTGTCGCCGAGGCCTACACCTCTGTTCAGTACTTGATGACCGATGTCAGCTTCGGCTGGCTGATTCGTTCGGTGCACCGTTGGAGTGCCTCGATGATGGTTCTCATGCTGATTTTGCATGTGTTCAGGGNNNNNNNNNNGGTGGTTTCAAGCGTCCTCGTGAGCTCACCTGGGTGACTGGTGTCACCATGGCTGTGATCACTGTTTCGTTCGGTGTTACTGGTTACTCCCTGCCTTGGGATCAAGTTGGCTACTGGGCTGTGAAAATTGTTTCCGGTGTTCCAGCAGCCATCCCCGTGGTGGGAGATTTCATGGTTGAGTTGCTCCGTGGTGGAGAGAGTGTTGGTCAATCGACTCTGACGCGTTTCTACAGCCTTCACACCTTTGTGATGCCATGGCTCCTCGCGGTG
>3
ATCGGCACAAAATACGTCCCCCCCCACGTCAATATTTTTTATTGCCTGGGCGGCATCACGCTTGTTTGCTTCCTGATTCAGTTCGCGACCGGGTTCGCGATGACTTTCTATTACAAGCCCACTGTTGCTGAGGCTTACAGCTCAGTTCAGTACCTGATGTCAGATGTGAGCTTCGGGTGGCTCATCCGCTCAGTTCACAGATGGAGCGCCTCGATGATGGTGCTCATGCTGATTCTCCACGTTTTCCGCGNNNNNNNNNNGGTGGCTTTAAGCGTCCTCGCGAGCTCACTTGGGTGACCGGCGTGACGATGGCAGTGATCACTGTTTCTTTTGGCGTTACCGGCTACTCACTCCCCTGGGATCAAGTTGGTTATTGGGCCGTCAAGATTGTTTCTGGAGTGCCTGCTGCCATTCCAGTTGTTGGTGACTTCATGGTTGAGCTGCTTCGTGGCGGCGAGAGTGTTGGTCAATCCACACTCACCCGCTTTTACAGCCTTCACACGTTTGTGATGCCTTGGTTGCTCGCTGTC
>4
ATCGGCACAAAATACGTCCCCCCCCACGTCAATATCTTTTATTGCCTGGGTGGGATCACGTTGGTCTGCTTCCTGATCCAGTTCGCGACAGGGTTCGCGATGACTTTCTATTACAAGCCCACTGTTGCTGAGGCTTACAGCTCAGTTCAGTACCTGATGTCAGATGTGAGCTTCGGGTGGCTCATCCGCTCAGTTCACAGATGGAGCGCCTCGATGATGGTGCTCATGCTGATTCTCCACGTTTTCCGCGNNNNNNNNNNGGTGGCTTTAAGCGTCCTCGCGAGCTCACTTGGGTGACCGGCGTGACGATGGCAGTGATCACTGTTTCTTTTGGCGTTACCGGCTACTCACTCCCCTGGGATCAAGTTGGTTATTGGGCCGTCAAGATTGTTTCTGGAGTGCCTGCTGCCATTCCAGTTGTTGGTGACTTCATGGTTGAGCTGCTTCGTGGCGGCGAGAGTGTTGGTCAATCCACACTCACCCGCTTCTACAGCCTTCACACGTTTGTGATGCCTTGGTTGCTCGCTGTC
>5
ATCGGCACAAAGTACGTCCCCCCCCACGTCAATATTTTCTATTGCCTGGGCGGCATCACGTTGGTCTGCTTCCTGATCCAGTTCGCGACAGGGTTCGCGATGACTTTCTATTACAAGCCAACAGTTGCTGAGGCGTATACCTCTGTTCAGTATCTGATGACTGATGTCAGCTTCGGCTGGCTGATTCGTTCGGTGCACCGTTGGAGTGCCTCGATGATGGTGCTCATGCTGATTTTGCATGTGTTCCGGGNNNNNNNNNNGGTGGTTTCAAACGTCCTCGTGAGCTCACCTGGGTGACTGGTGTCACCATGGCTGTGATCACGGTTTCGTTCGGTGTTACCGGCTACTCCCTTCCCTGGGATCAGGTTGGTTACTGGGCTGTGAAGATTGTCTCCGGCGTTCCTGCGGCCATTCCCGTGGTTGGAGACTTCATGGTTGAGTTACTCCGTGGTGGAGAAAGCGTTGGTCAATCGACTCTGACTCGCTTTTACAGCCTTCACACCTTCGTGATGCCTTGGCTCCTCGCGGTG
>6
TTCAGCACCAAGTACGTTCCGCCCCACGTCAATATTTTTTATTGCCTGGGCGGCATCACGCTTGTTTGCTTCCTGATTCAGTTCGCGACCGGGTTCGCGATGACTTTCTATTACAAGCCCACTGTTGCTGAGGCTTACAGCTCAGTTCAGTACCTGATGTCAGATGTGAGCTTCGGGTGGCTCATCCGCTCAGTTCACAGATGGAGCGCCTCGATGATGGTGCTCATGCTGATTCTCCACGTTTTCCGCGNNNNNNNNNNGGTGGCTTTAAGCGTCCTCGCGAGCTCACTTGGGTGACCGGCGTGACGATGGCAGTGATCACTGTTTCTTTTGGCGTTACCGGCTACTCACTCCCCTGGGATCAAGTTGGTTATTGGGCCGTCAAGATTGTTTCTGGAGTGCCTGCTGCCATTCCAGTTGTTGGTGACTTCATGGTTGAACTGCTGCGTGGTGGTGAGAGCGTTGGTCAATCCACACTCACTCGCTTCTACAGCCTTCACACGTTTGTGATGCCTTGGTTGCTTGCTGTC

At this settings there sequences are still fasely assigned as chimeras. BLAST the output in NCBI and it matches synechococcus.

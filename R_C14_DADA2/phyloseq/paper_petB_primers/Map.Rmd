---
title: "Supp figure 1 map"
author: "Denise Ong"
date: "3/22/2022"
output: html_document
---

#trying oceanmap package
```{r}
library(oceanmap)
library(dplyr)
library(here)

lat <- c(-46, -40)
lon <- c(172,-176)
plotmap(lon=lon, lat=lat)

sampling_location <-  readxl::read_excel(here("phyloseq", "paper_petB_primers", "figures_petb compare_1.0", "supp_sample_list_v1.xlsx"), sheet="original_cycle") %>%
    dplyr::select(lat, long) %>%
    distinct()
```

#trying rnatural earth package with ggplot (does not work over the 180 dateline)
```{r}
library(ggplot2)
library(rnaturalearth)
library(rnaturalearthdata)
library(sf)
library(rgeos)
library(ggspatial)

# load data
world <- ne_countries(scale = "medium", returnclass = "sf")

sampling_location <-  readxl::read_excel("phyloseq/figures_petb compare/supp_sample_list_v1.xlsx", sheet="original_cycle") %>%
    select(lat, long,cycle_name) %>%
    distinct()

#deal with dateline using st_shift_longitude
world_2 = st_shift_longitude(world)

sites_2 = st_as_sf(sampling_location,
                   coords = c("long", "lat"),
                   crs = 4326) %>%
  st_shift_longitude()

p<-ggplot() +
  geom_sf(data = world_2) +
  geom_sf(data = sites_2) +
  coord_sf(crs=4326,
           xlim = c(172,181), 
           ylim = c(-46, -42)) +
  annotation_scale(location = "br", width_hint = 0.25) +
  theme_bw()

p

pdf("phyloseq/map.pdf", height=4, width=6) ; plot(p) ; dev.off()
```


#trying ggoceanmaps package
```{r}
library(ggOceanMaps)
basemap(data= expand.grid(lon = c(-179, 172), lat = c(-46, -42)), rotate = TRUE) +
    geom_spatial_point(data = sampling_location, aes(x = long, y = lat)) +
  scale_y_continuous(breaks = seq(-179, 172, by = 1)) +
  scale_x_continuous(breaks = seq(-46, -42, by = 1)) 
basemap(limits = c(172, -176, -46, -40)) + # a synonym: basemap(dt)
  geom_spatial_point(data = sampling_location, aes(x = long, y = lat))
  geom_spatial_point(data = dt, aes(x = lon, y = lat), color = "red")
```

